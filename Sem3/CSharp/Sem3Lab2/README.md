Лабораторная работа № 2
=====================================

> Классы `XXXSettings` находятся в тех же файлах, что и классы `XXX`.
> Некоторые классы `XXXSettings` имеют несколько конструкторов с разными параметрами. Поэтому они могут быть созданы `ClassConstructor` [из Lab3](../Sem3Lab3) при неполном кол-ве параметрах в файлах конфигурации.
> В папке "exsamples" находятся примеры конфигурационных файлов, которые должны находится в директории приложения.

Реализовано:
------------

* Класс `DirectoryFileExtractor` мониторит папку `D:\in`. Класс `GZipFile` архивирует/деархивирует файл. Метод `Move` (в `DirectoryFileExtractor`) переносит файл из `sourceDirectory` в `targetDirectory`.

* Класс `AesFile` шифрует/дешифрует файл.

* Метод `Store` (в `DirectoryFileExtractor`) переносит файл в папку `archive` на target стороне

* Сервис реализован как Windows-служба

Особенности:
------------

* Для хранения очереди файлов, которые нужно перенести, используется `ConcurrentQueue`. Если файл в данный момент занят другим потоком (например, ещё не полностью создан), то он будет перенесён в конец очереди, чтобы вернуться к нему позже.

* Даже в случае возникновения исключения во время переноса файла (метод `Extract` в классе `DirectoryFileExtractor`), все созданные временные файлы будут удалены.

* Служба записывает успешные и неудачные попытки переноса файлов в `log.txt`.

* Службу можно безопасно приостановить `Pause ()` и немедленно остановить `Stop ()` (в классе `DirectoryFileExtractor`).

Краткое описание классов:
-------------------------

* `Program` - содержит `Main()`.

* `Installer1` устанавливает службу.

* `Service1` - сама служба.

* `DirectoryFileExtractor` мониторит каталог `sourceDirectory` на наличие файлов с расширением `searchExtension`. При появлении такого файла, архивирует, шифрует, переносит в каталог `targetDirectory`, дешифрует, разархивирует и поместит в подпапку  "archive".

* `DisposableFileInfo` - оболочка для класса `FileInfo`, которая реализует интерфейс `IDisposable`. Удобен для созданиия временных файлов, используя в операторе `using`.

* `GZipFile` архивирует/деархивирует файл. Архивированный файл получает расширение `fileExtension`.

* `AesFile` шифрует/дешифрует файлы методом AES.

* `StreamAesCryptor` шифрует/дешифрует поток методом AES, используя `Key` и `IV`. Экземпляр класса сможет дешифровать любой зашифрованный им поток.

* `OneoffCryptoStream` - улучшенный поток `CryptoStream`, который сам вызывает метод `IDisposable.Dispose()` у `ICryptoTransform` после своего использования.